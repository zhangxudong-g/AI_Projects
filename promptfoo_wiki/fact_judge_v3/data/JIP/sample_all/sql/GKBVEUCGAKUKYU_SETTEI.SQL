CREATE OR REPLACE FORCE VIEW GKBVEUCGAKUKYU_SETTEI
--1.0.000.000-02.02-02.02
--2024/06/03 ZCZL.chenying Update 0.3.000.000:新WizLIFE２次開発
--    (氏名漢字,氏名かな,性別,生年月日,宛名番号,履歴連番,学校区分コード,学校区分名称,
    (氏名漢字,氏名カナ,性別,生年月日,宛名番号,履歴連番,児童生徒_個人履歴番号枝番,学校区分コード,学校区分名称,
    学校等コード,学校等名称,学年コード,学年名称,学級コード,学級名称)
AS
SELECT JA.SHIMEI_KANJI,
       JA.SHIMEI_KANA,
       DECODE(JA.SEIBETSU,1,'男',2,'女',NULL) AS HYOJI_SEIBETSU,
       JA.SEINENGAPI,
       GR.KOJIN_NO,
       GR.RIREKI_RENBAN,
       GR.RIREKI_RENBAN_EDA,
       GR.GAKKO_KBN_CD,
       CASE GR.GAKKO_KBN_CD
       WHEN 1 THEN '小学校'
       WHEN 2 THEN '中学校'
       WHEN 3 THEN '特別支援学校'
       WHEN 4 THEN '区域外学校'
--2024/06/03 ZCZL.chenying Add 0.3.000.000:新WizLIFE２次開発
       WHEN 5 THEN '国私立学校'
       ELSE NULL END,
       CASE GR.GAKKO_KBN_CD
       WHEN 1 THEN GR.SYOGAKO_CD
       WHEN 2 THEN GR.TYUGAKO_CD
       WHEN 3 THEN GR.YOGOGAKO_CD
       WHEN 4 THEN GR.KUIKIGAI_CD
--2024/06/03 ZCZL.chenying Add 0.3.000.000:新WizLIFE２次開発
       WHEN 5 THEN GR.KUNISHIRITSU_CD
       ELSE NULL END AS GAKKO_CD,
       CASE GR.GAKKO_KBN_CD
       WHEN 1 THEN S.SYOGAKOMEI
       WHEN 2 THEN T.TYUGAKOMEI
       WHEN 3 THEN Y.YOGOGAKOMEI
       WHEN 4 THEN K.KUIKIGAIMEI
--2024/06/03 ZCZL.chenying Add 0.3.000.000:新WizLIFE２次開発
       WHEN 5 THEN KO.KUNISHIRITSUGAKKOMEI
       ELSE NULL END AS GAKKO_MEI,
       GR.GAKUNEN,
       GN.GAKUNENMEI,
       GR.GAKUKYU_CD,
       GK.GAKUKYU_MEI
FROM  GKBTGAKUREIBO GR,
      GKBTSHOGAKKO  S,
      GKBTCHUGAKKO  T,
      GKBTKUIKIGAI K,
      GKBTYOGOGAKKO Y,
      GKBTGAKUNEN GN,
      GKBTMSGAKUKYUCD GK,
      GABTATENAKIHON JA
--2024/06/03 ZCZL.chenying Add 0.3.000.000:新WizLIFE２次開発
      ,GKBTKUNISIRITSUGAKKO KO
WHERE GR.SAISHIN_KBN=0
 AND  GR.KOJIN_NO         = JA.KOJIN_NO  (+)
 AND  GR.SYOGAKO_CD       = S.SYOGAKO_CD (+)
 AND  GR.TYUGAKO_CD       = T.TYUGAKO_CD (+)
 AND  GR.KUIKIGAI_CD      = K.KUIKIGAI_CD(+)
 AND  GR.YOGOGAKO_CD      = Y.YOGOGAKO_CD(+)
--2024/06/03 ZCZL.chenying Add 0.3.000.000:新WizLIFE２次開発
 AND  GR.KUNISHIRITSU_CD  = KO.KUNISHIRITSUGAKKO_CD(+)
 AND  GR.GAKUNEN          = GN.GAKUNEN_CD
 AND  GR.GAKKO_KBN_CD     = GK.GAKKO_KBN_CD(+)
 AND  (CASE WHEN GR.GAKKO_KBN_CD = 1 THEN  GR.SYOGAKO_CD
            WHEN GR.GAKKO_KBN_CD = 2 THEN  GR.TYUGAKO_CD
            WHEN GR.GAKKO_KBN_CD = 3 THEN  GR.YOGOGAKO_CD
--2024/06/03 ZCZL.chenying Update start 0.3.000.000:新WizLIFE２次開発
--            WHEN GR.GAKKO_KBN_CD = 4 THEN  GR.KUIKIGAI_CD END)= GK.GAKKO_CD(+)
            WHEN GR.GAKKO_KBN_CD = 4 THEN  GR.KUIKIGAI_CD 
            WHEN GR.GAKKO_KBN_CD = 5 THEN  GR.KUNISHIRITSU_CD END)= GK.GAKKO_CD(+)
--2024/06/03 ZCZL.chenying Update end
 AND  GR.GAKUKYU_CD       = GK.GAKUKYU_CD(+)
ORDER BY GR.GAKKO_KBN_CD, GAKKO_CD, GR.GAKUNEN, JA.SHIMEI_KANA, JA.SEINENGAPI
/

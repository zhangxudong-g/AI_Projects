CREATE OR REPLACE FORCE VIEW GKBVEUCDVTAISHO
--1.0.010.001-02.02-02.02
--2025/07/15 CTC.GL UPDATE 1.0.010.001:GKB_QA18128対応
    (児童生徒宛名番号,児童生徒氏名かな,児童生徒氏名漢字,児童生徒生年月日,表示児童生徒生年月日,
    児童生徒DV期間から,児童生徒DV期間まで,保護者宛名番号,保護者氏名かな,
    保護者氏名漢字,保護者DV期間から,保護者DV期間まで,学年,
    小学校コード,小学校名,中学校コード,中学校名,区域外学校コード,区域外学校名,
    特別支援学校コード,特別支援学校名
--2024/06/03 ZCZL.chenying Add 0.3.000.000:新WizLIFE２次開発
    ,国私立学校コード,国私立学校名)
AS
SELECT  GAKUREIBO.KOJIN_NO
       ,ATENAJ.SHIMEI_KANA
       ,ATENAJ.SHIMEI_KANJI
       ,ATENAJ.SEINENGAPI
       ,ATENAJ.HYOJI_SEINENGAPI
--2024/06/03 ZCZL.chenying Update start 0.3.000.000:新WizLIFE２次開発
--       ,DVKANRI_JIDO.GAITO_KARA
--       ,DVKANRI_JIDO.GAITO_MADE
       ,least(DVKANRI_JIDO.IDOYOKUSHIKAISHIBI,
              DVKANRI_JIDO.HAKKOYOKUSHIKAISHIBI,
              DVKANRI_JIDO.SHOKAIYOKUSHIKAISHIBI)
       ,greatest(DVKANRI_JIDO.IDOYOKUSHISHURYOBI,
                 DVKANRI_JIDO.HAKKOYOKUSHISHURYOBI,
                 DVKANRI_JIDO.SHOKAIYOKUSHISHURYOBI)
--2024/06/03 ZCZL.chenying Update end
       ,GAKUREIBO.HOGOSYA_KOJIN_NO
       ,ATENAH.SHIMEI_KANA
       ,ATENAH.SHIMEI_KANJI
--2024/06/03 ZCZL.chenying Update start 0.3.000.000:新WizLIFE２次開発
--       ,DVKANRI_HOGOSYA.GAITO_KARA
--       ,DVKANRI_HOGOSYA.GAITO_MADE
       ,least(DVKANRI_HOGOSYA.IDOYOKUSHIKAISHIBI,
              DVKANRI_HOGOSYA.HAKKOYOKUSHIKAISHIBI,
              DVKANRI_HOGOSYA.SHOKAIYOKUSHIKAISHIBI)
       ,greatest(DVKANRI_HOGOSYA.IDOYOKUSHISHURYOBI,
                 DVKANRI_HOGOSYA.HAKKOYOKUSHISHURYOBI,
                 DVKANRI_HOGOSYA.SHOKAIYOKUSHISHURYOBI)
--2024/06/03 ZCZL.chenying Update end
       ,GAKUREIBO.GAKUNEN
       ,GAKUREIBO.SYOGAKO_CD
       ,SYOGAKO.SYOGAKOMEI
       ,GAKUREIBO.TYUGAKO_CD
       ,TYUGAKO.TYUGAKOMEI
       ,GAKUREIBO.KUIKIGAI_CD
       ,KUIKIGAI.KUIKIGAIMEI
       ,GAKUREIBO.YOGOGAKO_CD
       ,YOGOGAKO.YOGOGAKOMEI
--2024/06/03 ZCZL.chenying Add start 0.3.000.000:新WizLIFE２次開発
       ,GAKUREIBO.KUNISHIRITSU_CD
       ,KUNISIRITSUGAKKO.KUNISHIRITSUGAKKOMEI
--2024/06/03 ZCZL.chenying Add end
  FROM  GKBTGAKUREIBO  GAKUREIBO         --学齢簿
       ,GABTATENAKIHON ATENAJ            --宛名基本　児童
       ,GABTATENAKIHON ATENAH            --宛名基本　保護者
--2020/03/05 DIS.yangwzh update start 5.4.000.000:設計書変更の対応:DV管理テーブルは「EXT_DVKANRI」を「GACTKANRI」修正する。
--       ,EXT_DVKANRI    DVKANRI_JIDO      --ＤＶ管理マスタ
--       ,EXT_DVKANRI    DVKANRI_HOGOSYA   --ＤＶ管理マスタ
--2024/06/03 ZCZL.chenying Update start 0.3.000.000:新WizLIFE２次開発
--       ,GACTKANRI     DVKANRI_JIDO      --ＤＶ管理マスタ
--       ,GACTKANRI     DVKANRI_HOGOSYA   --ＤＶ管理マスタ
         ,GACTIDOHAKKOYOKUSHIKANRI     DVKANRI_JIDO      --ＤＶ管理マスタ
         ,GACTIDOHAKKOYOKUSHIKANRI     DVKANRI_HOGOSYA   --ＤＶ管理マスタ
--2024/06/03 ZCZL.chenying Update end
--2020/03/05 DIS.yangwzh update end
       ,GKBTSHOGAKKO    SYOGAKO           --小学校名
       ,GKBTCHUGAKKO    TYUGAKO           --中学校名
       ,GKBTKUIKIGAI    KUIKIGAI          --区域外学校名
       ,GKBTYOGOGAKKO   YOGOGAKO          --盲聾養護学校
--2024/06/03 ZCZL.chenying Add 0.3.000.000:新WizLIFE２次開発
       ,GKBTKUNISIRITSUGAKKO KUNISIRITSUGAKKO --国・私立学校名
--2020/03/05 DIS.yangwzh update start 5.4.000.000:設計書変更の対応:DV管理テーブルは「EXT_DVKANRI」を「GACTKANRI」修正する。
-- WHERE GAKUREIBO.KOJIN_NO = DVKANRI_JIDO.ATENA_NO(+) 
--   AND GAKUREIBO.HOGOSYA_KOJIN_NO = DVKANRI_HOGOSYA.ATENA_NO(+)
 WHERE GAKUREIBO.KOJIN_NO = DVKANRI_JIDO.KOJIN_NO(+) 
   AND GAKUREIBO.HOGOSYA_KOJIN_NO = DVKANRI_HOGOSYA.KOJIN_NO(+)
--2020/03/05 DIS.yangwzh update end
   AND GAKUREIBO.KOJIN_NO = ATENAJ.KOJIN_NO
   AND GAKUREIBO.HOGOSYA_KOJIN_NO = ATENAH.KOJIN_NO
--2020/03/18 DIS.yangwzh update start 受入検証の対応：設計書変更、各種の学校コードの結合条件を変更する。
--   AND GAKUREIBO.SYOGAKO_CD = SYOGAKO.SYOGAKO_CD
--   AND GAKUREIBO.TYUGAKO_CD = TYUGAKO.TYUGAKO_CD
--   AND GAKUREIBO.KUIKIGAI_CD = KUIKIGAI.KUIKIGAI_CD
--   AND GAKUREIBO.YOGOGAKO_CD = YOGOGAKO.YOGOGAKO_CD
   AND GAKUREIBO.SYOGAKO_CD = SYOGAKO.SYOGAKO_CD(+)
   AND GAKUREIBO.TYUGAKO_CD = TYUGAKO.TYUGAKO_CD(+)
   AND GAKUREIBO.KUIKIGAI_CD = KUIKIGAI.KUIKIGAI_CD(+)
   AND GAKUREIBO.YOGOGAKO_CD = YOGOGAKO.YOGOGAKO_CD(+)
--2020/03/18 DIS.yangwzh update end
--2024/06/03 ZCZL.chenying Add 0.3.000.000:新WizLIFE２次開発
   AND GAKUREIBO.KUNISHIRITSU_CD  = KUNISIRITSUGAKKO.KUNISHIRITSUGAKKO_CD (+) --国・私立学校名
--2024/06/03 ZCZL.chenying Update start 0.3.000.000:新WizLIFE２次開発
--   AND ((    DVKANRI_JIDO.GAITO_KARA <= TO_NUMBER(TO_CHAR(SYSDATE, 'YYYYMMDD'))
--         AND NVL(DVKANRI_JIDO.GAITO_MADE,99999999) >= TO_NUMBER(TO_CHAR(SYSDATE, 'YYYYMMDD')))
--        OR
--        (   DVKANRI_HOGOSYA.GAITO_KARA <= TO_NUMBER(TO_CHAR(SYSDATE, 'YYYYMMDD'))
--         AND NVL(DVKANRI_HOGOSYA.GAITO_MADE,99999999) >= TO_NUMBER(TO_CHAR(SYSDATE, 'YYYYMMDD'))))
   AND ((    least(DVKANRI_JIDO.IDOYOKUSHIKAISHIBI,
              DVKANRI_JIDO.HAKKOYOKUSHIKAISHIBI,
              DVKANRI_JIDO.SHOKAIYOKUSHIKAISHIBI) <= TO_NUMBER(TO_CHAR(SYSDATE, 'YYYYMMDD'))
         AND NVL(greatest(DVKANRI_JIDO.IDOYOKUSHISHURYOBI,
                 DVKANRI_JIDO.HAKKOYOKUSHISHURYOBI,
                 DVKANRI_JIDO.SHOKAIYOKUSHISHURYOBI),99999999) >= TO_NUMBER(TO_CHAR(SYSDATE, 'YYYYMMDD')))
        OR
        (   least(DVKANRI_HOGOSYA.IDOYOKUSHIKAISHIBI,
              DVKANRI_HOGOSYA.HAKKOYOKUSHIKAISHIBI,
              DVKANRI_HOGOSYA.SHOKAIYOKUSHIKAISHIBI) <= TO_NUMBER(TO_CHAR(SYSDATE, 'YYYYMMDD'))
         AND NVL(greatest(DVKANRI_HOGOSYA.IDOYOKUSHISHURYOBI,
                 DVKANRI_HOGOSYA.HAKKOYOKUSHISHURYOBI,
                 DVKANRI_HOGOSYA.SHOKAIYOKUSHISHURYOBI),99999999) >= TO_NUMBER(TO_CHAR(SYSDATE, 'YYYYMMDD'))))
--2024/06/03 ZCZL.chenying Update end
   AND GAKUREIBO.GAKUNEN BETWEEN 0 AND 9
   AND GAKUREIBO.GEN_JIYU_CD = 0
   AND GAKUREIBO.GEN_NENGAPI = 0
   AND GAKUREIBO.SAISHIN_KBN = 0
--  2025/07/15 CTC.GL UPDATE Start 1.0.010.001:GKB_QA18128対応
   AND GAKUREIBO.SAKUJO_FLG = 0
--  2025/07/15 CTC.GL UPDATE End
ORDER BY GAKUREIBO.GAKKO_KBN_CD
        ,GAKUREIBO.SYOGAKO_CD
        ,GAKUREIBO.TYUGAKO_CD
        ,GAKUREIBO.KUIKIGAI_CD
        ,GAKUREIBO.YOGOGAKO_CD
--2024/06/03 ZCZL.chenying Add 0.3.000.000:新WizLIFE２次開発
        ,GAKUREIBO.KUNISHIRITSU_CD
        ,GAKUREIBO.GAKUNEN
        ,ATENAJ.SHIMEI_KANA
/
COMMENT ON TABLE GKBVEUCDVTAISHO IS 'EUC_学齢簿DV対象者抽出'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.児童生徒宛名番号 IS '児童生徒宛名番号'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.児童生徒氏名かな IS '児童生徒氏名かな'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.児童生徒氏名漢字 IS '児童生徒氏名漢字'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.児童生徒生年月日 IS '児童生徒生年月日'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.表示児童生徒生年月日 IS '表示児童生徒生年月日'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.児童生徒DV期間から IS '児童生徒DV期間から'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.児童生徒DV期間まで IS '児童生徒DV期間まで'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.保護者宛名番号 IS '保護者宛名番号'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.保護者氏名かな IS '保護者氏名かな'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.保護者氏名漢字 IS '保護者氏名漢字'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.保護者DV期間から IS '保護者DV期間から'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.保護者DV期間まで IS '保護者DV期間まで'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.学年 IS '学年'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.小学校コード IS '小学校コード'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.小学校名 IS '小学校名'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.中学校コード IS '中学校コード'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.中学校名 IS '中学校名 '
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.区域外学校コード IS '区域外学校コード'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.区域外学校名 IS '区域外学校名'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.特別支援学校コード IS '特別支援学校コード'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.特別支援学校名 IS '特別支援学校名'
/
--2024/06/03 ZCZL.chenying Add start 0.3.000.000:新WizLIFE２次開発
COMMENT ON COLUMN GKBVEUCDVTAISHO.国私立学校コード is '国私立学校コード'
/
COMMENT ON COLUMN GKBVEUCDVTAISHO.国私立学校名 is '国私立学校名'
--2024/06/03 ZCZL.chenying Add end
/
